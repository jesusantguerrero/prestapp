import{z as m,m as d,G as g,E as h}from"./app-e7293397.js";import{c as y}from"./index-9dc2d84c.js";import{p as c}from"./index-3624ec38.js";import{f as u}from"./index-c251e33c.js";y(1996);const $=(e,a,s)=>{let i=[];if(a&&Object.entries(a).forEach(([t,l])=>{l&&i.push(`filter[${t}]=${l}`)}),s.startDate)try{let t=u(s.startDate,"yyyy-MM-dd");s.endDate&&(t+=`~${u(s.endDate,"yyyy-MM-dd")}`),i.push(`filter[${e}]=${t}`)}catch{return i.join("&")}return i.join("&")},b=e=>e&&`relationships=${e}`,P=e=>e.page&&`page=${e.page}&limit=${e.limit}`,p=e=>{let a=[$("date",e.filters,e.dates),b(e.relationships),P(e)];return e.search&&a.unshift(`search=${e.search}`),a.filter(s=>s==null?void 0:s.trim()).join("&")},D=e=>{h.get(e,void 0,{preserveState:!0})},S=(e,a,s={})=>{const i=f(e),t=m({filters:{...e.value.filters,date:null},dates:{startDate:i.startDate,endDate:i.endDate},sorts:e.value.sorts,limit:e.value.limit,relationships:e.value.relationships,search:e.value.search,page:e.value.page});d(()=>t,g.debounce(r=>{const n=p(r),o=window.location.toString();n!=o&&!s.manual&&a&&a(n)},400),{deep:!0});const l=()=>{const r=p(t);a&&a(r)};function f(r){var o;const n=(o=r==null?void 0:r.value.filters)!=null&&o.date?r.value.filters.date.split("~"):[null,null];return{startDate:c(n[0]),endDate:n.length==2?c(n[1]):null}}return{state:t,executeSearch:l,updateSearch:D,changeSize:r=>{t.limit=r,l()},paginate:r=>{t.page=r,l()},reset:()=>{t.search="",t.filters={},t.sorts="",l()}}};export{S as u};
