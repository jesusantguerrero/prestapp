import{o as d,f as y,a as e,l as V,C as M,c as C,w as l,b as a,j,h,t as o,F as E,g as u,E as P,ak as F,d as L,u as s,n as I,y as R,k as H,i as O}from"./app-494b6f90.js";import{_ as S}from"./sharp-payment-0e03bd0a.js";import{_ as z}from"./printer-011a5a3c.js";import{t as x}from"./atmosphere-ui-83e2a306.js";import{_ as q}from"./AppLayout.vue_vue_type_style_index_0_lang-3aae0800.js";import{u as N}from"./usePaymentModal-f96f741a.js";import{_ as b}from"./AppButton.vue_vue_type_script_setup_true_lang-6731c3fc.js";import{_ as J}from"./AppSectionHeader.vue_vue_type_script_setup_true_lang-5e6dc640.js";import{_ as U}from"./LoanSectionNav.vue_vue_type_script_setup_true_lang-185d9b4d.js";import{_ as Z}from"./AgreementFormModal.vue_vue_type_script_setup_true_lang-d33c1cda.js";import{f as r}from"./formatMoney-b7ef7683.js";import{f as D}from"./index-9dc2d84c.js";import{u as G}from"./usePrint-7af28820.js";const K={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},Q=e("path",{fill:"currentColor",d:"M21.71 8.71c1.25-1.25.68-2.71 0-3.42l-3-3c-1.26-1.25-2.71-.68-3.42 0L13.59 4H11C9.1 4 8 5 7.44 6.15L3 10.59v4l-.71.7c-1.25 1.26-.68 2.71 0 3.42l3 3c.54.54 1.12.74 1.67.74c.71 0 1.36-.35 1.75-.74l2.7-2.71H15c1.7 0 2.56-1.06 2.87-2.1c1.13-.3 1.75-1.16 2-2C21.42 14.5 22 13.03 22 12V9h-.59l.3-.29M20 12c0 .45-.19 1-1 1h-1v1c0 .45-.19 1-1 1h-1v1c0 .45-.19 1-1 1h-4.41l-3.28 3.28c-.31.29-.49.12-.6.01l-2.99-2.98c-.29-.31-.12-.49-.01-.6L5 15.41v-4l2-2V11c0 1.21.8 3 3 3s3-1.79 3-3h7v1m.29-4.71L18.59 9H11v2c0 .45-.19 1-1 1s-1-.55-1-1V8c0-.46.17-2 2-2h3.41l2.28-2.28c.31-.29.49-.12.6-.01l2.99 2.98c.29.31.12.49.01.6Z"},null,-1),W=[Q];function X(t,m){return d(),y("svg",K,W)}const Y={name:"mdi-handshake-outline",render:X},ee=e("i",{class:"fa fa-ellipsis-h"},null,-1),te=V({__name:"LoanOptions",props:{loan:null},setup(t){const m=t;N();const f={refinance:{label:"Reenganche"},reduceInterest:{label:"Reducir interes"},reduceInstallments:{label:"Reducir cuotas"},changeFrequency:{label:"Cambiar tipo"},cancel:{label:"Cancelar"},delete:{label:"Eliminar"}},w=(g,_)=>{var p;switch(g){case"refinance":P.visit(`/loans/${(p=m.loan)==null?void 0:p.id}/refinance`);break}};return(g,_)=>{const p=M("ElDropdownItem"),v=M("ElDropdownMenu"),$=M("ElDropdown");return f?(d(),C($,{key:0,onCommand:_[0]||(_[0]=c=>w(c,t.loan))},{dropdown:l(()=>[a(v,null,{default:l(()=>[(d(),y(E,null,j(f,(c,n)=>a(p,{command:n},{default:l(()=>[h(o(c.label),1)]),_:2},1032,["command"])),64))]),_:1})]),default:l(()=>[a(b,{variant:"neutral",class:"hover:bg-base-lvl-2"},{default:l(()=>[ee]),_:1})]),_:1})):u("",!0)}}}),ne={class:"mt-16"},se={class:"w-full px-6 pb-2 mb-5 space-y-5 text-gray-600 bg-white border-gray-200 shadow-md rounded-b-md"},ae={class:"flex justify-between space-x-4"},oe={class:"w-full"},le={class:"flex justify-between w-full"},ce=e("span",null," No.: ",-1),ie={class:"font-bold"},de={class:"flex justify-between w-full"},re=e("span",null," Fecha: ",-1),ue={class:"font-bold"},me={class:"flex justify-between w-full"},fe=e("span",null," Monto Prestado/Total a pagar: ",-1),_e={class:"font-bold"},pe={class:"w-full"},he={class:"flex justify-between w-full"},ye=e("span",null," Interes: ",-1),be={class:"font-bold"},we={class:"flex justify-between w-full"},ge=e("span",null," Pago/Modo: ",-1),xe={class:"font-bold"},ve={class:"flex justify-between w-full"},$e=e("span",null," Dias de gracia: ",-1),ke={class:"font-bold"},Me={class:"flex justify-between w-full"},Ce=e("span",null," Monto pagado: ",-1),Pe={class:"font-bold"},Ie={class:"flex space-x-2"},De={class:"flex flex-col md:flex-row w-full space-x-8 rounded-t-none border-t-none"},Ve={class:"flex space-x-4"},je={key:0,class:"w-full md:w-3/12 p-4 space-y-2 overflow-hidden border rounded-md shadow-md bg-base-lvl-3"},Ee={key:0,class:"grid grid-cols-1 gap-2"},Ne={class:"py-4 mt-8 space-y-2"},Be={key:0,class:"w-full px-2 py-4 rounded-md bg-base-lvl-2 text-body-1"},Ae=e("header",{class:"font-bold"},"Razon de cancelacion",-1),Ke=V({__name:"LoanTemplate",props:{loans:null,currentTab:{default:""},stats:null},setup(t){const m=t,[f,w]=F(),{openModal:g}=N(),_=L(()=>{var c;return(c=m.loans.client)==null?void 0:c.fullName}),p={"":"Detalles",payments:"Pagos",agreements:"Acuerdos de pago"},v=()=>{const c={amount:0,id:void 0,documents:m.loans.installments.map(n=>({name:`Cuota #${n.number}`,...n,amount:parseFloat(n.amount_due),payment:0})).filter(n=>parseFloat(n.amount||0))};g({data:{title:"Pagar cuotas multiples",endpoint:`/loans/${m.loans.id}/pay`,due:c.amount,account_id:"",payment:c,defaultConcept:"Pago cuotas multiples",accountsEndpoint:"/loan-accounts"},isOpen:!0})},{customPrint:$}=G("section-info");return(c,n)=>{const B=z,A=S,T=Y;return d(),C(q,{title:`Prestamo ${s(_)}`},{header:l(()=>[a(U,null,{actions:l(()=>[a(b,{variant:"neutral",onClick:n[0]||(n[0]=i=>s(P).visit(`/loans/${t.loans.id}/edit`))},{default:l(()=>[h(" Editar ")]),_:1}),a(b,{variant:"neutral",onClick:n[1]||(n[1]=i=>s($)())},{default:l(()=>[a(B)]),_:1}),a(te,{loan:t.loans,class:"py-2"},null,8,["loan"])]),_:1})]),default:l(()=>[e("main",ne,[a(J,{name:"Prestamo a",class:"px-5 border-2 rounded-md rounded-b-none shadow-md",resource:t.loans,title:s(_),"hide-action":"",onCreate:n[2]||(n[2]=i=>s(P).visit("/loans/create"))},null,8,["resource","title"]),e("section",se,[e("header",ae,[e("section",oe,[e("p",le,[ce,e("span",ie,o(t.loans.id),1)]),e("p",de,[re,e("span",ue,o(s(D)(t.loans.date)),1)]),e("p",me,[fe,e("span",_e,o(s(r)(t.loans.amount))+" / "+o(s(r)(t.loans.total??0)),1)])]),e("section",pe,[e("p",he,[ye,e("span",be,o(t.loans.interest_rate)+" %",1)]),e("p",we,[ge,e("span",xe,o(t.loans.payment)+"/ "+o(t.loans.frequency),1)]),e("p",ve,[$e,e("span",ke,o(t.loans.grace_days)+" Dias",1)]),e("p",Me,[Ce,e("span",Pe,o(s(r)(t.loans.amount_paid??0)),1)])])]),e("footer",Ie,[(d(),y(E,null,j(p,(i,k)=>a(s(R),{class:I(["px-2 py-1 transition rounded-md cursor-pointer bg-gray-50 hover:bg-gray-200",{"bg-primary/10 text-primary font-bold":k==t.currentTab}]),key:k,href:`/loans/${t.loans.id}/${k}`,replace:""},{default:l(()=>[h(o(i),1)]),_:2},1032,["class","href"])),64))])]),e("section",De,[e("article",{id:"section-info",class:I(["w-full space-y-2 overflow-auto",[t.loans.payment_status=="PAID"?"w-full":" md:w-9/12"]])},[e("section",Ve,[a(s(x),{class:"w-full bg-white border h-28 text-body-1",title:"Capital pendiente",value:s(r)(t.stats.outstandingPrincipal)},null,8,["value"]),a(s(x),{class:"w-full bg-white border h-28 text-body-1",title:"Interes pendiente",value:s(r)(t.stats.outstandingInterest)},null,8,["value"]),a(s(x),{class:"w-full bg-white border h-28 text-body-1",title:"Mora pendiente",value:s(r)(t.stats.outstandingFees)},null,8,["value"]),a(s(x),{class:"w-full bg-white border h-28 text-body-1",title:"Monto pendiente",value:s(r)(t.stats.outstandingTotal)},null,8,["value"])]),H(c.$slots,"default")],2),t.loans.payment_status!=="PAID"?(d(),y("article",je,[t.loans.payment_status!=="PAID"?(d(),y("section",Ee,[a(b,{onClick:n[3]||(n[3]=i=>v()),class:"flex items-center justify-center text-sm"},{default:l(()=>[a(A,{class:"mr-2"}),h(" Recibo Multiple ")]),_:1}),u("",!0),t.loans.payment_status!=="PAID"?(d(),C(b,{key:1,onClick:n[4]||(n[4]=i=>s(w)()),variant:"secondary",class:"flex items-center justify-center text-sm"},{default:l(()=>[a(T,{class:"mr-1"}),h(" Acuerdo de pago ")]),_:1})):u("",!0),u("",!0)])):u("",!0),e("section",Ne,[t.loans.cancelled_at?(d(),y("div",Be,[e("h4",null,"Cancelado en "+o(s(D)(t.loans.cancelled_at,"dd MMMM yyyy")),1),Ae,h(" "+o(t.loans.cancel_reason),1)])):u("",!0)])])):u("",!0)])]),a(Z,{modelValue:s(f),"onUpdate:modelValue":[n[5]||(n[5]=i=>O(f)?f.value=i:null),n[6]||(n[6]=i=>s(w)(!1))],loan:t.loans},null,8,["modelValue","loan"])]),_:3},8,["title"])}}});export{Ke as _};
