import{_ as F}from"./bank-minus-89ce58d3.js";import{t as g}from"./atmosphere-ui-83e2a306.js";import{l as P,z as E,m as j,P as A,c as N,w as l,o as f,b as s,a as n,u as r,f as v,F as C,j as z,h as b,t as y,y as D,E as T,M as S,W as G,Y as J}from"./app-494b6f90.js";import{_ as L}from"./BaseSelect.vue_vue_type_style_index_1_lang-7b13fe11.js";import{_ as U}from"./AppLayout.vue_vue_type_style_index_0_lang-3aae0800.js";import{_ as W}from"./PropertySectionNav.vue_vue_type_script_setup_true_lang-d424aeb5.js";import{f as Y}from"./index-9dc2d84c.js";import{_ as q}from"./BaseTable.vue_vue_type_style_index_0_lang-39691f37.js";import{_ as $}from"./AppButton.vue_vue_type_script_setup_true_lang-6731c3fc.js";import{a as H}from"./user-outline-c87acd59.js";import{f as h}from"./formatMoney-b7ef7683.js";import{_ as K}from"./_plugin-vue_export-helper-c27b6911.js";import"./PaymentFormModal.vue_vue_type_script_setup_true_lang-2fd658ef.js";import"./close-40de6817.js";import"./PaymentGrid-a2bc0bdb.js";import"./mathHelper-d6bc48cd.js";import"./exact-math.node-f7579f9b.js";import"./constants-0a903a05.js";import"./AccountSelect.vue_vue_type_script_setup_true_lang-93902e28.js";import"./AppFormField.vue_vue_type_style_index_0_lang-2eb2a149.js";import"./index-c251e33c.js";import"./index-81f33ca2.js";import"./Modal.vue_vue_type_script_setup_true_lang-ca2f799a.js";import"./InvoiceFormModal.vue_vue_type_script_setup_true_lang-d4cb9813.js";import"./ClientFormModal.vue_vue_type_script_setup_true_lang-593db1f8.js";import"./ClientForm.vue_vue_type_script_setup_true_lang-7ced5882.js";import"./SectionNav.vue_vue_type_script_setup_true_lang-3cbc58a3.js";import"./usePaymentModal-f96f741a.js";import"./FastAccessOptions.vue_vue_type_script_setup_true_lang-ff3d4599.js";import"./menus-f4817d1f.js";import"./index-3624ec38.js";import"./customCell-9e9ed16f.js";const Q=i=>(G("data-v-ce5f39c2"),i=i(),J(),i),R={class:"py-10 mx-auto sm:px-6 lg:px-8"},X={class:"flex space-x-4"},Z={class:"mt-4 bg-base-lvl-3 rounded-md overflow-hidden px-1"},ee={class:"font-bold text-gray-300"},te=Q(()=>n("i",{class:"fa fa-user text-xs"},null,-1)),ae={class:"flex justify-end px-4 py-2 space-x-2"},oe={key:1,class:"h-48 flex items-center justify-center"},re=P({__name:"OwnerDraws",props:{invoices:{type:Array},properties:{type:Array,default(){return[]}},owners:{type:Array,default(){return[]}},outstanding:{type:Number},paid:{type:Number},lateDays:{type:Number}},setup(i){const c=E({owner:null,property:null});j(()=>c,()=>{const t=Object.entries(c).reduce((e,[m,a])=>(e[m]=a==null?void 0:a.id,e),{});T.get(location.pathname,{filters:t},{preserveState:!0})},{deep:!0});const k=t=>{const{columns:e,data:m}=t,a=[];return e.forEach((_,d)=>{if(d===1){a[d]="Monto a pagar desde cuenta de immobiliaria";return}const o=m.map(u=>Number(u[_.property]));if(o.every(u=>Number.isNaN(u)))a[d]="";else{const u=o.reduce((w,x)=>{const V=Number(x);return Number.isNaN(V)?w:w+x},0);a[d]=h(u)}}),a},I=[{name:"description",label:"Descripcion / Cliente",width:400},{name:"due_date",label:"Fecha",align:"center",class:"text-center",width:120,render(t){return Y(t.due_date)}},{name:"property_name",label:"Propiedad"},{name:"total",label:"Disponible para pago",render(t){return h(t.total)}}],p=A({client:null,invoices:[]});function M(t){p.invoices=t.map(e=>({id:e.id,total:e.total}))}function B(){var t,e;if(!((t=c.owner)!=null&&t.id)){S({title:"Sin Propietario",message:"Por favor seleccione el propietario para generar la factura",type:"error"});return}p.post(`/owners/${(e=c.owner)==null?void 0:e.id}/draws`,{onSuccess(){S({title:"Creada",message:"Factura de propiedad creada con exito",type:"success"})}})}const{openModal:O}=H("invoice");return(t,e)=>{const m=F;return f(),N(U,{title:"Centro de pago"},{header:l(()=>[s(W,null,{actions:l(()=>[s(L,{modelValue:c.owner,"onUpdate:modelValue":e[0]||(e[0]=a=>c.owner=a),endpoint:"/api/clients?filter[is_owner]=1",placeholder:"Selecciona un dueÃ±o",label:"display_name","track-by":"id"},null,8,["modelValue"])]),_:1})]),default:l(()=>{var a,_;return[n("div",R,[n("section",X,[s(r(g),{class:"w-full bg-white border h-28 text-body-1",title:"Pagado",value:r(h)(i.paid??0)},null,8,["value"]),s(r(g),{class:"w-full bg-white border h-28 text-body-1",title:"Balance de Pendiente",value:r(h)(i.outstanding??0)},null,8,["value"]),s(r(g),{class:"w-full bg-white border h-28 text-body-1",title:"Dias de mora",value:i.lateDays||0},null,8,["value"])]),n("div",Z,[(a=i.invoices)!=null&&a.length?(f(),v(C,{key:0},[(f(!0),v(C,null,z(i.invoices,d=>(f(),N(q,{class:"mt-0","table-class":"px-0","show-summary":"",selectable:"",onSelectionChange:M,"summary-method":k,cols:I,"table-data":d.invoices},{description:l(({scope:{row:o}})=>[n("section",null,[n("p",null,[s(r(D),{href:`/${o.type=="INVOICE"?"invoices":"bills"}/${o.id}`,class:"text-blue-400 capitalize border-b border-blue-400 border-dashed cursor-pointer text-sm"},{default:l(()=>[b(y(o.description)+" ",1),n("span",ee,y(o.series)+" #"+y(o.number),1)]),_:2},1032,["href"])]),n("p",null,[s(r(D),{class:"text-sm text-body-1 mt-2",href:`/clients/${o.client_id||o.contact_id}`},{default:l(()=>[te,b(" "+y(o.owner_name),1)]),_:2},1032,["href"])])])]),_:2},1032,["table-data"]))),256)),n("footer",ae,[s($,{variant:"error",onClick:e[1]||(e[1]=d=>!r(p).processing&&r(O)({data:{},isOpen:!0})),disabled:r(p).processing},{default:l(()=>[s(m,{class:"mr-2"}),b(" Crear Gasto ")]),_:1},8,["disabled"]),s($,{variant:"secondary",onClick:B,processing:r(p).processing,disabled:!((_=c.owner)!=null&&_.id)},{default:l(()=>[b(" Crear Factura de distribucion ")]),_:1},8,["processing","disabled"])])],64)):(f(),v("p",oe," No hay facturas para pagar al propietario "))])])]}),_:1})}}});const je=K(re,[["__scopeId","data-v-ce5f39c2"]]);export{je as default};
