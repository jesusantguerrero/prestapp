import{_ as E}from"./trash-b41c2bba.js";import{_ as F}from"./file-8bfe57ae.js";import{_ as T}from"./sharp-payment-a1c72b2d.js";import{_ as z}from"./chevron-right-5280f715.js";import{t as b}from"./atmosphere-ui-86b7f8ed.js";import{l as A,z as O,m as U,r as $,c as f,w as i,C as G,o as u,b as s,a as d,u as l,g as _,h as L,f as R,E as g,N as k,aa as q}from"./app-e7293397.js";import{_ as C}from"./BaseSelect.vue_vue_type_style_index_1_lang-cbd59430.js";import{_ as J}from"./AppLayout.vue_vue_type_style_index_0_lang-96d4f03f.js";import{_ as H}from"./InvoiceTable.vue_vue_type_script_setup_true_lang-83fc6fbb.js";import{_ as K}from"./PropertySectionNav.vue_vue_type_script_setup_true_lang-516e104c.js";import{f as h}from"./formatMoney-b7ef7683.js";import{_ as v}from"./AppButton.vue_vue_type_script_setup_true_lang-046c4e1c.js";import{u as Q}from"./usePaymentModal-ad844d5c.js";import{u as W}from"./usePrint-7af28820.js";import X from"./Simple-2187f807.js";import{_ as Y}from"./ButtonGroup.vue_vue_type_script_setup_true_lang-6c7ef160.js";import{a as Z}from"./BaseTable.vue_vue_type_style_index_0_lang-efd97e4a.js";import{I as ee,c as te}from"./ClientForm.vue_vue_type_script_setup_true_lang-f1abe81a.js";import{_ as oe}from"./_plugin-vue_export-helper-c27b6911.js";import"./PaymentFormModal.vue_vue_type_script_setup_true_lang-dd64f8b8.js";import"./close-f1b40d6b.js";import"./PaymentGrid-6607ced0.js";import"./mathHelper-95aa3a2b.js";import"./exact-math.node-9a256fc0.js";import"./constants-0a903a05.js";import"./AccountSelect.vue_vue_type_script_setup_true_lang-cb870c82.js";import"./AppFormField.vue_vue_type_style_index_0_lang-d6998fd8.js";import"./index-c251e33c.js";import"./index-81f33ca2.js";import"./Modal.vue_vue_type_script_setup_true_lang-53b90f8d.js";import"./InvoiceFormModal.vue_vue_type_script_setup_true_lang-88bfc502.js";import"./user-outline-dcfa7b13.js";import"./ClientFormModal.vue_vue_type_script_setup_true_lang-d0093e27.js";import"./FastAccessOptions.vue_vue_type_script_setup_true_lang-1fc13d45.js";import"./constants-7016751c.js";import"./index-9dc2d84c.js";import"./index-3624ec38.js";import"./menus-f4817d1f.js";import"./SectionNav.vue_vue_type_script_setup_true_lang-e0dfad64.js";import"./index-1a0c9adf.js";import"./InvoiceTotals.vue_vue_type_style_index_0_lang-9e8793e7.js";import"./InvoiceGrid-960550dc.js";import"./IconTrash-b225eb02.js";import"./AtTable.vue_vue_type_script_setup_true_lang-805493b4.js";import"./customCell-f0a6687f.js";import"./ClientCard.vue_vue_type_script_setup_true_lang-721ae044.js";import"./BusinessCard.vue_vue_type_script_setup_true_lang-2db3943c.js";import"./index-4b317f4f.js";import"./constants-22f9a1fe.js";const se={class:"py-10 mx-auto sm:px-6 lg:px-8"},ae={class:"flex space-x-4"},ne={class:"flex space-x-4 mt-4"},re={class:"flex justify-end items-center space-x-2s"},ie={class:"flex space-x-2"},le={key:0,id:"invoice-content"},ce=A({__name:"ManagementTools",props:{invoices:{type:Array},type:{type:String},outstanding:{type:Number},paid:{type:Number},lateDays:{type:Number},properties:{type:Array,default(){return[]}},owners:{type:Array,default(){return[]}},businessData:{type:Object,required:!0},user:{type:Object},section:{type:String}},setup(n){const a=O({owner:null,property:null,section:n.section});U(()=>a,()=>{const e=Object.entries(a).reduce((o,[m,r])=>(o[m]=(r==null?void 0:r.value)??r,o),{});g.get(location.pathname,{filters:e},{preserveState:!0})},{deep:!0});const{openModal:V}=Q(),w=e=>{const o={...e,amount:parseFloat(e.debt)||e.total,id:void 0,invoice_id:e.id},m={bills:`/owners/${e.client_id}/draws/${e==null?void 0:e.id}/payments`,invoices:`/rents/${e.invoiceable_id}/invoices/${e==null?void 0:e.id}/payments`},r=m[a.section]??m.invoices;k(()=>{V({data:{title:`Pagar ${e.concept}`,payment:o,endpoint:r,due:o==null?void 0:o.amount,defaultConcept:"Pago de "+e.concept,accountsEndpoint:"/invoices",hideAccountSelector:!0}})})},c=$(null),{customPrint:M}=W(),p=$(!1);function P(e){p.value=e.id,axios.get(`/invoices/${e.id}/preview?json=true`).then(({data:o})=>{c.value=o,k(()=>{M("invoice-content",{beforePrint(){c.value=null},delay:800})})}).then(()=>{p.value=!1})}const I=()=>{},S={commissions:{label:"Comisiones"},invoices:{label:"Facturas"},bills:{label:"Gastos"}},j=async e=>{await q.confirm(`Estas seguro de eliminar la factura ${e.concept} por ${h(e.total)}?`,"Eliminar factura")&&g.delete(`/invoices/${e.id}`,{onSuccess(){g.reload({preserveState:!0,preserveScroll:!0})}})};return(e,o)=>{const m=z,r=G("Link"),D=T,N=F,B=E;return u(),f(J,{title:"Centro de pago"},{header:i(()=>[s(K)]),default:i(()=>{var x;return[d("div",se,[d("section",ae,[s(l(b),{class:"w-full bg-white border h-28 text-body-1",title:"Pagado",value:l(h)(n.paid??0)},null,8,["value"]),s(l(b),{class:"w-full bg-white border h-28 text-body-1",title:"Balance de Pendiente",value:l(h)(n.outstanding??0)},null,8,["value"]),s(l(b),{class:"w-full bg-white border h-28 text-body-1",title:"Dias de mora",value:n.lateDays||0},null,8,["value"])]),d("section",ne,[s(Z,{modelValue:a.search,"onUpdate:modelValue":o[0]||(o[0]=t=>a.search=t),modelModifiers:{lazy:!0},class:"w-full md:flex","has-filters":!0},null,8,["modelValue"]),s(C,{class:"min-w-max",size:e.large,options:n.owners,placeholder:"Filtrar por dueÃ±o",modelValue:a.owner,"onUpdate:modelValue":o[1]||(o[1]=t=>a.owner=t)},null,8,["size","options","modelValue"]),s(C,{placeholder:"Filtrar",options:[],modelValue:a.status,"onUpdate:modelValue":o[2]||(o[2]=t=>a.status=t),label:"label","track-by":"name"},null,8,["modelValue"]),s(Y,{class:"w-full md:w-fit","onUpdate:modelValue":[I,o[3]||(o[3]=t=>a.section=t)],values:S,modelValue:a.section},null,8,["modelValue"])]),s(l(H),{"invoice-data":n.invoices,class:"mt-10 rounded-md bg-base-lvl-3"},{actions:i(({row:t})=>[d("div",re,[s(r,{class:"relative inline-block cursor-pointer ml-4 hover:bg-primary hover:text-white px-5 py-2 overflow-hidden font-bold text-body transition rounded-md focus:outline-none hover:bg-opacity-80 min-w-max",href:`/properties/${t.property_id}?unit=${t.id}`},{default:i(()=>[s(m)]),_:2},1032,["href"]),(t==null?void 0:t.status)!=="paid"?(u(),f(v,{key:0,onClick:y=>w(t),variant:"inverse-secondary",class:"flex items-center justify-center"},{default:i(()=>[s(D)]),_:2},1032,["onClick"])):_("",!0),d("div",ie,[s(v,{class:"hover:text-primary transition items-center flex flex-col justify-center hover:border-primary-400",variant:"neutral",processing:p.value==t.id,disabled:p.value==t.id,onClick:y=>P(t)},{default:i(()=>[s(N)]),_:2},1032,["processing","disabled","onClick"]),a.section=="bills"&&t.status!="paid"?(u(),f(v,{key:0,class:"mr-2",variant:"neutral",process:l(ee).isGeneratingDistribution,onClick:y=>l(te).generateOwnerDistribution(t.contact_id,t.id)},{default:i(()=>[L(" Re-generar ")]),_:2},1032,["process","onClick"])):_("",!0)]),s(v,{variant:"neutral",class:"hover:text-error transition items-center flex flex-col justify-center hover:border-red-400",onClick:y=>j(t)},{default:i(()=>[s(B)]),_:2},1032,["onClick"])])]),_:1},8,["invoice-data"])]),c.value?(u(),R("div",le,[(x=c.value)!=null&&x.invoice?(u(),f(X,{key:0,user:n.user,type:n.type,"business-data":c.value.businessData,"invoice-data":c.value.invoice},null,8,["user","type","business-data","invoice-data"])):_("",!0)])):_("",!0)]}),_:1})}}});const rt=oe(ce,[["__scopeId","data-v-186692d0"]]);export{rt as default};
