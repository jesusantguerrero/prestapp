import{o as c,f as g,a as t,l as q,d as x,r as w,c as p,w as r,u as o,b as i,h as m,g as v,E as h,t as l,j as E,n as Z,y as j,F as I,N as z}from"./app-e7293397.js";import{_ as J}from"./edit-3340e0a9.js";import{_ as U}from"./bank-minus-ed476f28.js";import{_ as K}from"./AppLayout.vue_vue_type_style_index_0_lang-96d4f03f.js";import{_}from"./AppButton.vue_vue_type_script_setup_true_lang-046c4e1c.js";import{_ as Q}from"./AppSectionHeader.vue_vue_type_script_setup_true_lang-4f8015fe.js";import{_ as W}from"./PropertySectionNav.vue_vue_type_script_setup_true_lang-516e104c.js";import{_ as X}from"./InvoiceCard.vue_vue_type_script_setup_true_lang-26337e5b.js";import{_ as Y}from"./PaymentFormModal.vue_vue_type_script_setup_true_lang-dd64f8b8.js";import{_ as P}from"./WelcomeWidget.vue_vue_type_script_setup_true_lang-f5ad8b33.js";import{f as C}from"./index-9dc2d84c.js";import{a as ee}from"./user-outline-dcfa7b13.js";import{_ as te}from"./UnitTitle.vue_vue_type_script_setup_true_lang-c25f773c.js";import{f as k}from"./formatMoney-b7ef7683.js";import"./atmosphere-ui-86b7f8ed.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal.vue_vue_type_script_setup_true_lang-53b90f8d.js";import"./AccountSelect.vue_vue_type_script_setup_true_lang-cb870c82.js";import"./BaseSelect.vue_vue_type_style_index_1_lang-cbd59430.js";import"./AppFormField.vue_vue_type_style_index_0_lang-d6998fd8.js";import"./index-c251e33c.js";import"./index-81f33ca2.js";import"./InvoiceFormModal.vue_vue_type_script_setup_true_lang-88bfc502.js";import"./close-f1b40d6b.js";import"./mathHelper-95aa3a2b.js";import"./exact-math.node-9a256fc0.js";import"./constants-0a903a05.js";import"./ClientFormModal.vue_vue_type_script_setup_true_lang-d0093e27.js";import"./ClientForm.vue_vue_type_script_setup_true_lang-f1abe81a.js";import"./SectionNav.vue_vue_type_script_setup_true_lang-e0dfad64.js";import"./constants-22f9a1fe.js";import"./usePaymentModal-ad844d5c.js";import"./FastAccessOptions.vue_vue_type_script_setup_true_lang-1fc13d45.js";import"./menus-f4817d1f.js";import"./constants-7016751c.js";import"./PaymentGrid-6607ced0.js";import"./index-3624ec38.js";import"./chevron-right-5280f715.js";const ne={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},oe=t("path",{fill:"currentColor",d:"M21.12 15.46L19 17.59l-2.12-2.13l-1.42 1.42L17.59 19l-2.13 2.12l1.42 1.42L19 20.41l2.12 2.13l1.42-1.42L20.41 19l2.13-2.12M6 2c-1.11 0-2 .89-2 2v16c0 1.11.89 2 2 2h7.81c-.53-.91-.81-1.95-.81-3c0-.33.03-.67.08-1H6v-2h7.81c.46-.8 1.1-1.5 1.87-2H6v-2h12v1.08c.33-.05.67-.08 1-.08c.34 0 .67.03 1 .08V8l-6-6m-1 1.5L18.5 9H13Z"},null,-1),se=[oe];function ae(e,u){return c(),g("svg",ne,se)}const re={name:"mdi-file-document-remove",render:ae},ie={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},le=t("path",{fill:"currentColor",d:"M15 15v2h3v3h2v-3h3v-2h-3v-3h-2v3m-3.03-3.39C14.85 10.28 13.59 8.97 12 9c-1.7.03-3 1.3-3 3s1.3 2.94 3 3c.38 0 .77-.08 1.14-.23c.27-1.1.72-2.14 1.83-3.16M13 16H7a2 2 0 0 0-2-2v-4c1.11 0 2-.89 2-2h10a2 2 0 0 0 2 2v.06c.67 0 1.34.12 2 .34V6H3v12h10.32a6.38 6.38 0 0 1-.32-2Z"},null,-1),ce=[le];function de(e,u){return c(),g("svg",ie,ce)}const me={name:"mdi-cash-plus",render:de},ue={class:"p-5 mt-16 md:mt-8"},pe={class:"flex space-x-2"},fe={class:"w-full px-5 pt-10 pb-2 mb-5 space-y-5 text-gray-600 bg-white rounded-b-md"},ve={class:"flex space-x-2"},he={class:"flex flex-col md:flex-row w-full md:space-x-8 rounded-t-none border-t-none"},_e={class:"w-full md:w-9/12 space-y-2"},ge={class:"py-4 space-y-2"},ye={class:"hover:bg-base-lvl-1 cursor-pointer py-2"},we={class:"w-full md:w-3/12 mt-4 md:mt-0 p-4 space-y-2 rounded-md bg-base-lvl-3"},$e={class:"flex space-x-4"},be={class:"py-4 mt-8 space-y-2"},xe={key:0,class:"text-sm"},Ce={class:"font-bold text-green-500"},ke={class:"font-bold text-primary"},Me=["href"],mt=q({__name:"Show",props:{rents:null,currentTab:{default:"summary"}},setup(e){const u=e,{openModal:M}=ee("invoice"),N={summary:"Detalles",transactions:"Pagos",invoices:"Facturas",expenses:"Gastos"},$=x(()=>{var s;return u.rents.client.names+" "+((s=u.rents.client)==null?void 0:s.lastnames)}),V=x(()=>`${$.value.split(",")[0]}`),b=w(!1),d=w(null),A=s=>{d.value={...s,amount:parseFloat(s.debt)||s.total,id:void 0,invoice_id:s.id},b.value=!0},F=x(()=>d.value&&`Pago ${u.rents.id} pago #${d.value.installment_id}`),y=w(""),L=w(),T=s=>{y.value=`/invoices/${s.id}/print`,console.log(y.value,s),z(()=>{L.value.click(),y.value=""})},B=(s,n)=>{switch(s){case"payment":A(n);break;case"download":T(n);break}},D=()=>{h.reload()},H=()=>{h.post(`/rents/${u.rents.id}/generate-next-invoice`,{onSuccess(){D()}})};return(s,n)=>{const O=U,S=me,G=J,R=re;return c(),p(K,{title:o(V)},{header:r(()=>[i(W)]),default:r(()=>[t("main",ue,[i(Q,{name:"Contrato de Alquiler a",class:"px-5 bg-white border-2 border-white rounded-md rounded-b-none",resource:e.rents,title:`${o($)}`,"hide-action":"",onCreate:n[3]||(n[3]=a=>o(h).visit("/loans/create"))},{actions:r(()=>[t("section",pe,[e.rents.status!=="CANCELLED"?(c(),p(_,{key:0,variant:"error",onClick:n[0]||(n[0]=a=>o(M)({data:{type:"expense",clientId:e.rents.client_id,rentId:e.rents.id,hideClientOptions:!0},isOpen:!0}))},{default:r(()=>[i(O,{class:"mr-2"}),m(" Crear Gasto ")]),_:1})):v("",!0),e.rents.status!=="CANCELLED"?(c(),p(_,{key:1,variant:"success",onClick:n[1]||(n[1]=a=>o(M)({data:{type:"fee",clientId:e.rents.client_id,rentId:e.rents.id,hideClientOptions:!0,title:"Crear cargo de mora"},isOpen:!0}))},{default:r(()=>[i(S,{class:"mr-2"}),m(" Crear Mora ")]),_:1})):v("",!0),i(_,{variant:"neutral",onClick:n[2]||(n[2]=a=>o(h).visit(s.route("rents.edit",e.rents)))},{default:r(()=>[i(G)]),_:1})])]),_:1},8,["resource","title"]),t("div",fe,[t("div",null,"Alquiler #"+l(e.rents.id)+" para "+l(o($)),1),t("div",ve,[(c(),g(I,null,E(N,(a,f)=>i(o(j),{class:Z(["px-2 py-1 transition rounded-md cursor-pointer bg-gray-50 hover:bg-gray-200",{"bg-gray-300":f==e.currentTab}]),key:f,href:`/rents/${e.rents.id}?current-tab=${f}`,replace:""},{default:r(()=>[m(l(a),1)]),_:2},1032,["class","href"])),64))])]),t("section",he,[t("article",_e,[i(P,{message:"Detalles de contrato",class:"w-full text-body-1"},{content:r(()=>[t("section",ge,[t("p",null," Mensualidad: "+l(e.rents.amount),1),t("p",null," Fecha de Inicio: "+l(o(C)(e.rents.date)),1),t("p",null," Proximo pago: "+l(o(C)(e.rents.next_invoice_date)),1),t("p",null," Estatus: "+l(s.$t(`commons.${e.rents.status}`)),1),t("p",ye," Deposito "+l(o(k)(e.rents.deposit)),1)])]),actions:r(()=>[e.rents.status!=="CANCELLED"?(c(),p(_,{key:0,variant:"neutral",class:"hover:bg-error hover:text-white",onClick:n[4]||(n[4]=a=>o(h).visit(`/clients/${e.rents.client_id}/rents/${e.rents.id}/end`))},{default:r(()=>[i(R,{class:"mr-2"}),m(" Terminar Contrato ")]),_:1})):v("",!0)]),_:1}),i(P,{message:"Detalles de propiedad",class:"w-full text-body-1"},{content:r(()=>{var a;return[i(te,{class:"mt-4 hover:bg-white cursor-pointer px-4 py-2 bg-white rounded-md",title:e.rents.address+" "+((a=e.rents.unit)==null?void 0:a.name),"owner-name":e.rents.owner_name,"owner-link":`/contacts/${e.rents.property.owner_id}/owners`,"tenant-name":o(k)(e.rents.amount)},null,8,["title","owner-name","owner-link","tenant-name"])]}),_:1})]),t("article",we,[t("section",$e,[i(_,{class:"w-full",variant:"secondary",onClick:H},{default:r(()=>[m(" Generar proximo pago ")]),_:1})]),t("section",be,[e.rents.transaction?(c(),g("div",xe,[m(l(e.rents.transaction.description)+" ",1),t("span",Ce,l(o(k)(e.rents.transaction.total)),1),m(" en "),t("span",ke,l(o(C)(e.rents.date)),1)])):v("",!0),(c(!0),g(I,null,E(e.rents.invoices,a=>(c(),p(X,{invoice:a,actions:{payment:{label:"Registrar Pago"},send:{label:"Enviar Correo"},download:{label:"Descargar PDF"},view:{label:"Ver factura"},delete:{label:"Eliminar Factura"}},onAction:f=>B(f,a)},null,8,["invoice","onAction"]))),256))])])]),d.value?(c(),p(Y,{key:0,modelValue:b.value,"onUpdate:modelValue":n[5]||(n[5]=a=>b.value=a),title:"Pagar Renta",payment:d.value,endpoint:`/rents/${e.rents.id}/invoices/${d.value.invoice_id}/pay`,due:d.value.amount,"default-concept":o(F),onSaved:n[6]||(n[6]=a=>D())},null,8,["modelValue","payment","endpoint","due","default-concept"])):v("",!0),t("a",{href:y.value,download:"",target:"_blank",ref_key:"invoiceLink",ref:L,type:"hidden"},null,8,Me)])]),_:1},8,["title"])}}});export{mt as default};
