import{l as V,r as d,d as I,C as u,o as p,f as _,c as $,w as s,b as g,F as E,j as M,h as T,t as B,g as F,a as m,N as b,aa as L,E as y}from"./app-e7293397.js";import{u as A}from"./usePaymentModal-ad844d5c.js";import{f as O}from"./formatMoney-b7ef7683.js";const j=m("button",{class:"px-5 py-2 rounded-md hover:bg-base-lvl-2"},[m("i",{class:"fa fa-ellipsis-h"})],-1),G=["href"],z=V({__name:"InvoicePaymentOptions",props:{invoice:null,accountsEndpoint:{default:"/api/accounts"}},setup(a){const l=a,{openModal:w}=A(),f={payment:{label:"Registrar Pago"},send:{label:"Enviar Correo"},download:{label:"Descargar PDF"},view:{label:"Ver factura"},delete:{label:"Eliminar Factura"}},t=d(null),C=I(()=>t.value&&`Pago ${l.invoice.concept}`),k=e=>{t.value={...e,amount:parseFloat(e.debt)||e.total,id:void 0,invoice_id:e.id},b(()=>{var o,n;w({data:{title:`Pagar ${e.concept}`,payment:t.value,endpoint:`/invoices/${(o=l.invoice)==null?void 0:o.id}/payment`,due:(n=t.value)==null?void 0:n.amount,defaultConcept:C.value,accountsEndpoint:l.accountsEndpoint}})})},r=d(""),v=d(),x=e=>{r.value=`/invoices/${e.id}/print`,b(()=>{v.value.click(),r.value=""})},D=async e=>{await L.confirm(`Estas seguro de eliminar la factura ${e.concept} por ${O(e.total)}?`,"Eliminar factura")&&y.delete(`/invoices/${e.id}`,{onSuccess(){y.reload({preserveState:!0,preserveScroll:!0})}})},P=(e,o)=>{switch(e){case"payment":k(o);break;case"download":x(o);break;case"delete":D(o);break}};return(e,o)=>{const n=u("ElDropdownItem"),h=u("ElDropdownMenu"),S=u("ElDropdown");return p(),_(E,null,[f?(p(),$(S,{key:0,onCommand:o[0]||(o[0]=i=>P(i,a.invoice))},{dropdown:s(()=>[g(h,null,{default:s(()=>[(p(),_(E,null,M(f,(i,N)=>g(n,{command:N},{default:s(()=>[T(B(i.label),1)]),_:2},1032,["command"])),64))]),_:1})]),default:s(()=>[j]),_:1})):F("",!0),m("a",{href:r.value,target:"_blank",ref_key:"invoiceLink",ref:v,type:"hidden"},null,8,G)],64)}}}),J={paid:"Pagado",unpaid:"Pendiente",overdue:"Tardio"},c={unpaid:{color:"text-body-1",iconClass:"fa fa-circle"},paid:{color:"text-success",iconClass:"fa fa-check"},overdue:{color:"text-warning",iconClass:"fa fa-exclamation"},PENDING:{color:"text-info",iconClass:""}},H=a=>J[a]||a,K=a=>c[a]&&c[a].iconClass,Q=a=>c[a]&&c[a].color;export{z as _,H as a,Q as b,K as g};
