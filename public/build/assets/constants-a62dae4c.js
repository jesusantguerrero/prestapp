import{l as V,r as d,d as I,C as u,o as p,f as _,c as $,w as s,b as E,F as b,j as M,h as B,t as F,g as T,a as m,N as g,aa as L,E as y}from"./app-494b6f90.js";import{u as A}from"./usePaymentModal-f96f741a.js";import{f as O}from"./formatMoney-b7ef7683.js";const j=m("button",{class:"px-5 py-2 rounded-md hover:bg-base-lvl-2"},[m("i",{class:"fa fa-ellipsis-h"})],-1),G=["href"],z=V({__name:"InvoicePaymentOptions",props:{invoice:null,accountsEndpoint:{default:"/api/accounts"}},setup(a){const l=a,{openModal:k}=A(),f={payment:{label:"Registrar Pago"},send:{label:"Enviar Correo"},download:{label:"Descargar PDF"},view:{label:"Ver factura"},delete:{label:"Eliminar Factura"}},t=d(null),w=I(()=>t.value&&`Pago ${l.invoice.concept}`),C=e=>{t.value={...e,amount:parseFloat(e.debt)||e.total,id:void 0,invoice_id:e.id},g(()=>{var o,n;k({data:{title:`Pagar ${e.concept}`,payment:t.value,endpoint:`/invoices/${(o=l.invoice)==null?void 0:o.id}/payment`,due:(n=t.value)==null?void 0:n.amount,defaultConcept:w.value,accountsEndpoint:l.accountsEndpoint}})})},r=d(""),v=d(),D=e=>{r.value=`/invoices/${e.id}/print`,g(()=>{v.value.click(),r.value=""})},P=async e=>{await L.confirm(`Estas seguro de eliminar la factura ${e.concept} por ${O(e.total)}?`,"Eliminar factura")&&y.delete(`/invoices/${e.id}`,{onSuccess(){y.reload({preserveState:!0,preserveScroll:!0})}})},h=(e,o)=>{switch(e){case"payment":C(o);break;case"download":D(o);break;case"delete":P(o);break}};return(e,o)=>{const n=u("ElDropdownItem"),x=u("ElDropdownMenu"),S=u("ElDropdown");return p(),_(b,null,[f?(p(),$(S,{key:0,onCommand:o[0]||(o[0]=i=>h(i,a.invoice))},{dropdown:s(()=>[E(x,null,{default:s(()=>[(p(),_(b,null,M(f,(i,N)=>E(n,{command:N},{default:s(()=>[B(F(i.label),1)]),_:2},1032,["command"])),64))]),_:1})]),default:s(()=>[j]),_:1})):T("",!0),m("a",{href:r.value,target:"_blank",ref_key:"invoiceLink",ref:v,type:"hidden"},null,8,G)],64)}}}),J={paid:"Pagado",unpaid:"Pendiente"},c={unpaid:{color:"text-body-1",iconClass:"fa fa-circle"},paid:{color:"text-success",iconClass:"fa fa-check"},PENDING:{color:"text-info",iconClass:""}},H=a=>J[a]||a,K=a=>c[a]&&c[a].iconClass,Q=a=>c[a]&&c[a].color;export{z as _,H as a,Q as b,K as g};
