import{_ as H}from"./edit-c2d315cc.js";import{o as d,f as g,a as t,l as R,d as w,r as v,c as x,w as l,u as a,b as r,h as m,E as h,t as i,j as I,n as j,y as z,F as D,g as V,N as J}from"./app-494b6f90.js";import{_ as U}from"./bank-minus-89ce58d3.js";import{_ as Z}from"./AppLayout.vue_vue_type_style_index_0_lang-3aae0800.js";import{_}from"./AppButton.vue_vue_type_script_setup_true_lang-6731c3fc.js";import{_ as K}from"./AppSectionHeader.vue_vue_type_script_setup_true_lang-5e6dc640.js";import{_ as Q}from"./PropertySectionNav.vue_vue_type_script_setup_true_lang-d424aeb5.js";import{_ as W}from"./InvoiceCard.vue_vue_type_script_setup_true_lang-ccb04f01.js";import{_ as X}from"./PaymentFormModal.vue_vue_type_script_setup_true_lang-2fd658ef.js";import{_ as F}from"./WelcomeWidget.vue_vue_type_script_setup_true_lang-801aae9c.js";import{f as $}from"./index-9dc2d84c.js";import{a as Y}from"./user-outline-c87acd59.js";import{_ as ee}from"./UnitTitle.vue_vue_type_script_setup_true_lang-ad071be3.js";import{f as k}from"./formatMoney-b7ef7683.js";import"./atmosphere-ui-83e2a306.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./Modal.vue_vue_type_script_setup_true_lang-ca2f799a.js";import"./AccountSelect.vue_vue_type_script_setup_true_lang-93902e28.js";import"./BaseSelect.vue_vue_type_style_index_1_lang-7b13fe11.js";import"./AppFormField.vue_vue_type_style_index_0_lang-2eb2a149.js";import"./index-c251e33c.js";import"./index-81f33ca2.js";import"./InvoiceFormModal.vue_vue_type_script_setup_true_lang-d4cb9813.js";import"./close-40de6817.js";import"./mathHelper-d6bc48cd.js";import"./exact-math.node-f7579f9b.js";import"./constants-0a903a05.js";import"./ClientFormModal.vue_vue_type_script_setup_true_lang-593db1f8.js";import"./ClientForm.vue_vue_type_script_setup_true_lang-7ced5882.js";import"./SectionNav.vue_vue_type_script_setup_true_lang-3cbc58a3.js";import"./usePaymentModal-f96f741a.js";import"./FastAccessOptions.vue_vue_type_script_setup_true_lang-ff3d4599.js";import"./menus-f4817d1f.js";import"./constants-a62dae4c.js";import"./PaymentGrid-a2bc0bdb.js";import"./index-3624ec38.js";import"./chevron-right-182a2a80.js";const te={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"},ne=t("path",{fill:"currentColor",d:"M15 15v2h3v3h2v-3h3v-2h-3v-3h-2v3m-3.03-3.39C14.85 10.28 13.59 8.97 12 9c-1.7.03-3 1.3-3 3s1.3 2.94 3 3c.38 0 .77-.08 1.14-.23c.27-1.1.72-2.14 1.83-3.16M13 16H7a2 2 0 0 0-2-2v-4c1.11 0 2-.89 2-2h10a2 2 0 0 0 2 2v.06c.67 0 1.34.12 2 .34V6H3v12h10.32a6.38 6.38 0 0 1-.32-2Z"},null,-1),ae=[ne];function oe(e,u){return d(),g("svg",te,ae)}const se={name:"mdi-cash-plus",render:oe},re={class:"p-5 mt-16 md:mt-8"},ie={class:"flex space-x-2"},le={class:"w-full px-5 pt-10 pb-2 mb-5 space-y-5 text-gray-600 bg-white rounded-b-md"},ce={class:"flex space-x-2"},de={class:"flex flex-col md:flex-row w-full md:space-x-8 rounded-t-none border-t-none"},me={class:"w-full md:w-9/12 space-y-2"},ue={class:"py-4 space-y-2"},pe={class:"hover:bg-base-lvl-1 cursor-pointer py-2"},fe={class:"w-full md:w-3/12 mt-4 md:mt-0 p-4 space-y-2 rounded-md bg-base-lvl-3"},ve={class:"flex space-x-4"},he={class:"py-4 mt-8 space-y-2"},_e={key:0,class:"text-sm"},ge={class:"font-bold text-green-500"},ye={class:"font-bold text-primary"},be=["href"],ot=R({__name:"Show",props:{rents:null,currentTab:{default:"summary"}},setup(e){const u=e,{openModal:C}=Y("invoice"),N={summary:"Detalles",transactions:"Pagos",invoices:"Facturas",expenses:"Gastos"},y=w(()=>{var o;return u.rents.client.names+" "+((o=u.rents.client)==null?void 0:o.lastnames)}),T=w(()=>`${y.value.split(",")[0]}`),b=v(!1),c=v(null),B=o=>{c.value={...o,amount:parseFloat(o.debt)||o.total,id:void 0,invoice_id:o.id},b.value=!0},E=w(()=>c.value&&`Pago ${u.rents.id} pago #${c.value.installment_id}`),f=v(""),M=v(),A=o=>{f.value=`/invoices/${o.id}/print`,console.log(f.value,o),J(()=>{M.value.click(),f.value=""})},O=(o,n)=>{switch(o){case"payment":B(n);break;case"download":A(n);break}},P=()=>{h.reload()},S=()=>{h.post(`/rents/${u.rents.id}/generate-next-invoice`,{onSuccess(){P()}})};return(o,n)=>{const G=U,L=se,q=H;return d(),x(Z,{title:a(T)},{header:l(()=>[r(Q)]),default:l(()=>[t("main",re,[r(K,{name:"Contrato de Alquiler a",class:"px-5 bg-white border-2 border-white rounded-md rounded-b-none",resource:e.rents,title:`${a(y)}`,"hide-action":"",onCreate:n[3]||(n[3]=s=>a(h).visit("/loans/create"))},{actions:l(()=>[t("section",ie,[r(_,{variant:"error",onClick:n[0]||(n[0]=s=>a(C)({data:{type:"expense",clientId:e.rents.client_id,rentId:e.rents.id,hideClientOptions:!0},isOpen:!0}))},{default:l(()=>[r(G,{class:"mr-2"}),m(" Crear Gasto ")]),_:1}),r(_,{variant:"success",onClick:n[1]||(n[1]=s=>a(C)({data:{type:"fee",clientId:e.rents.client_id,rentId:e.rents.id,hideClientOptions:!0,title:"Crear cargo de mora"},isOpen:!0}))},{default:l(()=>[r(L,{class:"mr-2"}),m(" Crear Mora ")]),_:1}),r(_,{variant:"neutral",onClick:n[2]||(n[2]=s=>a(h).visit(o.route("rents.edit",e.rents)))},{default:l(()=>[r(q)]),_:1})])]),_:1},8,["resource","title"]),t("div",le,[t("div",null,"Alquiler #"+i(e.rents.id)+" para "+i(a(y)),1),t("div",ce,[(d(),g(D,null,I(N,(s,p)=>r(a(z),{class:j(["px-2 py-1 transition rounded-md cursor-pointer bg-gray-50 hover:bg-gray-200",{"bg-gray-300":p==e.currentTab}]),key:p,href:`/rents/${e.rents.id}?current-tab=${p}`,replace:""},{default:l(()=>[m(i(s),1)]),_:2},1032,["class","href"])),64))])]),t("section",de,[t("article",me,[r(F,{message:"Detalles de contrato",class:"w-full text-body-1"},{content:l(()=>[t("section",ue,[t("p",null," Mensualidad: "+i(e.rents.amount),1),t("p",null," Fecha de Inicio: "+i(a($)(e.rents.date)),1),t("p",null," Proximo pago: "+i(a($)(e.rents.next_invoice_date)),1),t("p",null," Estatus: "+i(e.rents.status),1),t("p",pe," Deposito "+i(a(k)(e.rents.deposit)),1)])]),_:1}),r(F,{message:"Detalles de propiedad",class:"w-full text-body-1"},{content:l(()=>{var s;return[r(ee,{class:"mt-4 hover:bg-white cursor-pointer px-4 py-2 bg-white rounded-md",title:e.rents.address+" "+((s=e.rents.unit)==null?void 0:s.name),"owner-name":e.rents.owner_name,"owner-link":`/contacts/${e.rents.property.owner_id}/owners`,"tenant-name":a(k)(e.rents.amount)},null,8,["title","owner-name","owner-link","tenant-name"])]}),_:1})]),t("article",fe,[t("section",ve,[r(_,{class:"w-full",variant:"secondary",onClick:S},{default:l(()=>[m(" Generar proximo pago ")]),_:1})]),t("section",he,[e.rents.transaction?(d(),g("div",_e,[m(i(e.rents.transaction.description)+" ",1),t("span",ge,i(a(k)(e.rents.transaction.total)),1),m(" en "),t("span",ye,i(a($)(e.rents.date)),1)])):V("",!0),(d(!0),g(D,null,I(e.rents.invoices,s=>(d(),x(W,{invoice:s,actions:{payment:{label:"Registrar Pago"},send:{label:"Enviar Correo"},download:{label:"Descargar PDF"},view:{label:"Ver factura"},delete:{label:"Eliminar Factura"}},onAction:p=>O(p,s)},null,8,["invoice","onAction"]))),256))])])]),c.value?(d(),x(X,{key:0,modelValue:b.value,"onUpdate:modelValue":n[4]||(n[4]=s=>b.value=s),title:"Pagar Renta",payment:c.value,endpoint:`/rents/${e.rents.id}/invoices/${c.value.invoice_id}/pay`,due:c.value.amount,"default-concept":a(E),onSaved:n[5]||(n[5]=s=>P())},null,8,["modelValue","payment","endpoint","due","default-concept"])):V("",!0),t("a",{href:f.value,download:"",target:"_blank",ref_key:"invoiceLink",ref:M,type:"hidden"},null,8,be)])]),_:1},8,["title"])}}});export{ot as default};
